spring:
  application:
    name: analytics-service
  
  kafka:
    bootstrap-servers: ${KAFKA_BOOTSTRAP_SERVERS:localhost:9092}
    streams:
      application-id: analytics-service
      properties:
        '[default.key.serde]': org.apache.kafka.common.serialization.Serdes$StringSerde
        '[default.value.serde]': org.springframework.kafka.support.serializer.JsonSerde
        '[commit.interval.ms]': 1000
        '[cache.max.bytes.buffering]': 10485760
        '[state.dir]': /tmp/kafka-streams
    
    consumer:
      group-id: analytics-consumer-group
      auto-offset-reset: earliest
      enable-auto-commit: false
      key-deserializer: org.apache.kafka.common.serialization.StringDeserializer
      value-deserializer: org.springframework.kafka.support.serializer.JsonDeserializer
      properties:
        '[spring.json.trusted.packages]': pt.lunasoft.models
  
  data:
    redis:
      host: ${REDIS_HOST:localhost}
      port: ${REDIS_PORT:6379}
      password: ${REDIS_PASSWORD:}
      timeout: 2000ms

server:
  port: 8082
  compression:
    enabled: true

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  metrics:
    prometheus:
      enabled: true
    tags:
      application: ${spring.application.name}
  tracing:
    sampling:
      probability: 1.0

logging:
  level:
    '[pt.lunasoft]': DEBUG
    '[org.apache.kafka.streams]': INFO
    '[org.springframework.kafka]': INFO

# InfluxDB Configuration
influxdb:
  url: ${INFLUXDB_URL:http://localhost:8086}
  token: ${INFLUXDB_TOKEN:your-token}
  org: ${INFLUXDB_ORG:finstream}
  bucket: ${INFLUXDB_BUCKET:analytics}

# Custom Application Properties
app:
  kafka:
    topics:
      transactions-incoming: transactions.incoming
      transactions-validated: transactions.validated
      fraud-alerts: fraud.alerts
      analytics-aggregated: analytics.aggregated
  
  analytics:
    window:
      size-minutes: 5
      grace-period-minutes: 1
    aggregation:
      enabled: true